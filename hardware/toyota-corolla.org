#+TITLE: Toyota Corolla
#+LANGUAGE: en
#+CREATOR: Emacs 25.2.2 (Org mode 9.1.13)

#+BEGIN_EXPORT html
<base href="toyota-corolla/"/>
#+END_EXPORT

It's my car. It currently hosts the [[file:../../projects/whitestar/][whitestar]] equipment. It's a 2006 Toyota Corolla with a 1.4L Diesel engine. I have been collecting fuel consumption
data for a while now and I have compiled a chart to summarize the fuel economy of the car as a variable of the average speed for each trip. This allows to
easily distinguish between in-city and highway driving.

[[file:fuel-corolla-public-metric.png]]

Also there is an MPG chart more useful for US-based viewers:

[[file:fuel-corolla-public-mpg.png]]

In the interest of full disclosure there is also the [[file:fuel-corolla.dat][input data]] and [[file:fuel-corolla-public.gnuplot][gnuplot script]] to generate the charts.

** Device CD-Text support results

|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
| Head unit identification          | AVC-LAN Connector on head unit side | Accessory type      | Accessory identification  | AVC-LAN Connector on accessory side | Result    | Notes                 |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
| OE no. 86120-02380                | [[https://pinoutguide.com/Car-Stereo-Toyota-Lexus/Toyota_W58814_Head_Unit_pinout.shtml][CN702 12P]]                           | CD Changer          | Front: TM0461             | R4 connector                        | OK        | CD-Text not supported |
| Ref no. CQ-TS7471LC               |                                     |                     | Type: 74833               |                                     |           |                       |
| ID no. W58814                     |                                     |                     | OE no. 08601-00910        |                                     |           |                       |
| Type: W58814                      |                                     |                     | Ref no. CX-CS0721F        |                                     |           |                       |
| Toyota code: e13                  |                                     |                     | Toyota code: e13          |                                     |           |                       |
| Datecode: 022018                  |                                     |                     | Datecode: 020209          |                                     |           |                       |
| Manufacturer: Panasonic           |                                     |                     | Manufacturer: Panasonic   |                                     |           |                       |
| [[file:cqts7471a.pdf][Service Manual]]                    |                                     |                     |                           |                                     |           |                       |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
| OE no. 86120-12880                |                                     |                     |                           |                                     |           |                       |
| Ref no. CQ-TS7471A                |                                     |                     |                           |                                     |           |                       |
| Type: W58814                      |                                     |                     |                           |                                     |           |                       |
| Toyota code: e13                  |                                     |                     |                           |                                     |           |                       |
| Datecode: 022018                  |                                     |                     |                           |                                     |           |                       |
| Manufacturer: Matsushita Electric |                                     |                     |                           |                                     |           |                       |
| Serial no. 73707                  |                                     |                     |                           |                                     |           |                       |
| Label no. YEFM01663A              |                                     |                     |                           |                                     |           |                       |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
|                                   |                                     | CD Changer          | Front: TM0461             | R4 connector                        | No owned  |                       |
|                                   |                                     |                     | Type: 74833               |                                     |           |                       |
|                                   |                                     |                     | OE no. 08601-00911        |                                     |           |                       |
|                                   |                                     |                     | Ref no. CX-CS0722FC       |                                     |           |                       |
|                                   |                                     |                     | Toyota code: e13          |                                     |           |                       |
|                                   |                                     |                     | Datecode: 020209          |                                     |           |                       |
|                                   |                                     |                     | Manufacturer: Panasonic   |                                     |           |                       |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
|                                   |                                     | CD Changer          | Front: TM0461             | R4 connector                        | Not owned |                       |
|                                   |                                     |                     | Type: 74833               |                                     |           |                       |
|                                   |                                     |                     | OE no. 08601-00912        |                                     |           |                       |
|                                   |                                     |                     | Ref no. CX-CS0723FC       |                                     |           |                       |
|                                   |                                     |                     | Toyota code: e13          |                                     |           |                       |
|                                   |                                     |                     | Datecode: 020209          |                                     |           |                       |
|                                   |                                     |                     | Manufacturer: Panasonic   |                                     |           |                       |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|
|                                   |                                     | CD Changer emulator | APPS2Car                  | No connector                        | OK        |                       |
|                                   |                                     |                     | [[https://www.wiki-tech.com]] |                                     |           |                       |
|                                   |                                     |                     |                           |                                     |           |                       |
|                                   |                                     |                     |                           |                                     |           |                       |
|                                   |                                     |                     |                           |                                     |           |                       |
|                                   |                                     |                     |                           |                                     |           |                       |
|-----------------------------------+-------------------------------------+---------------------+---------------------------+-------------------------------------+-----------+-----------------------|

** Replacement connectors for Toyota units

The connectors on the back of a Toyota head unit can be replaced with the following replacement connector types.

|--------+----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------|
| Unit   | Toyota Connector Reference | Replacement connector | Replacement connector description                                                                                                               |
|--------+----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------|
| W58814 | [[https://pinoutguide.com/Car-Stereo-Toyota-Lexus/Toyota_W58814_Head_Unit_pinout.shtml][CN702 12P]]                  | [[https://www.te.com/usa-en/product-1318774-1.html][TE 1318774-1]]          | Housing for Female Terminals, Wire-to-Board / Wire-to-Device / Wire-to-Wire, 12 Position, .087 in [2.2 mm] Centerline, TH/.025 Connector System |
| W58814 | [[https://pinoutguide.com/Car-Stereo-Toyota-Lexus/Toyota_W58814_Head_Unit_pinout.shtml][CN703 20P]]                  | TBD                   |                                                                                                                                                 |
| W58814 | [[https://pinoutguide.com/Car-Stereo-Toyota-Lexus/Toyota_W58814_Head_Unit_pinout.shtml][CN704 8P]]                   | [[https://www.te.com/usa-en/product-1376352-1.html][TE 1376352-1]]          | Housing for Female Terminals, Wire-to-Wire / Wire-to-Device / Wire-to-Board, 8 Position, .087 in [2.2 mm] Centerline, TH/.025 Connector System  |
|--------+----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------|


[[https://www.priuswiki.de/index.php?title=Audiosystem&oldid=13774][Prius wiki article about Prius audio system mentioning support for CD-Text]]

|----------------+--------------------------+---------+-----------------------------------------------|
| Accessory type | Accessory identification | Offer   | Notes                                         |
|----------------+--------------------------+---------+-----------------------------------------------|
| CD Changer     | Front: TM0561            |         | Prius, [[https://servicemanuals.us/panasonic/car-audio/cx-cs0820fa.html][Service manual]]                         |
|                | Type: 74835              |         |                                               |
|                | OE no. 08601-00907       |         |                                               |
|                | Ref no. CX-CS0820FA      |         |                                               |
|                | Manufacturer: Panasonic  |         |                                               |
|----------------+--------------------------+---------+-----------------------------------------------|
| CD Changer     | Front: TF0411            | [[https://allegro.pl/oferta/toyota-prius-01-zmieniarka-cd-08601-00893-12747197680][allegro]] | Prius                                         |
|                | Type: 34245              |         |                                               |
|                | OE no. 08601-00893       |         |                                               |
|                | Ref no. 113001-56310151  |         |                                               |
|                | Toyota code: e13         |         |                                               |
|                | Datecode: 020319         |         |                                               |
|                | Manufacturer: Fujitsu    |         |                                               |
|----------------+--------------------------+---------+-----------------------------------------------|
| CD Changer     | Front: TF0411            | [[https://allegro.pl/oferta/zmieniarka-odtwarzacz-cd-toyota-prius-08601-00906-11618050560][allegro]] | Prius, weird as labels do not match the above |
|                | Type: 34245              |         |                                               |
|                | OE no. 08601-00906       |         |                                               |
|                | Ref no. 113001-56310151  |         |                                               |
|                | Toyota code: e13         |         |                                               |
|                | Datecode: 020319         |         |                                               |
|                | Manufacturer: Fujitsu    |         |                                               |
|----------------+--------------------------+---------+-----------------------------------------------|
| iPod interface | OE no. PZ473-00261-A0    |         |                                               |

[[https://adoc.pub/yaris-5dv-hatchback.html][CD-Text from iPod in Yaris 5dv hatchback]]

Attachment code for an official iPod connector to Toyota Yaris from the above site is PZ473-00261-A0

This attachment is also mentioned for Toyota RAV4

https://manualzz.com/doc/5191320/tarif-accessoires-rav4-2005

[[file:46fe114aefafac38d14de01a67f2cadeb1bfbd6abc9e518f01891ce4c8f49ae0.pdf][A summary of audio options for Toyota]] containing various front codes and the description of the accessories.

*** DIY development wire harness

[[file:diy-iebus-harness.svg]]
*** Radio LAN diagnostics mode enter

To enter the LAN diagnostics mode the following steps need to be taken:

- Turn off the audio system and turn the IG switch to ACC. While pressing the preset switches ”1” and ”6” at the same time, press ”CD” 3 times.
- Reference: Beep sound is given 3 times and the system enters the service check mode. It may take about 40 sec. to complete the check.

Refer to the DIAGNOSTICS (05-599) chapter for the AUDIO SYSTEM [[file:precheck.pdf][Repair Manual]] for a detailed description.

In the service check mode, the system check and the diagnosis memory check are performed, and the check results are displayed in ascending order of the
device codes. (physical address)

In the CQ-TS7471LC radio that I have without any external devices connected apart from the power supply the following codes are reported as "GOOD":

|------------------+----------------+-----------|
| Physical address | Physical label | Condition |
|------------------+----------------+-----------|
| P160             | AUDIO H/U      | GOOD      |
| P190             | AUDIO H/U      | GOOD      |
|------------------+----------------+-----------|

When the TM0461 CD Changer is connected an additional code appears:

|------------------+----------------+-----------|
| Physical address | Physical label | Condition |
|------------------+----------------+-----------|
| P160             | AUDIO H/U      | GOOD      |
| P190             | AUDIO H/U      | GOOD      |
| P360             | CD-CH1         | GOOD      |
|------------------+----------------+-----------|

When an Aliexpress-sourced APPS2Car CD Changer emulator is connected the codes reported now are:

|------------------+----------------+-----------+--------------------------------+------------------------------------------+------------------------------------------------------------------------------------|
| Physical address | Physical label | Condition | DTC Codes                      | DTC Interpreted                          | Notes                                                                              |
|------------------+----------------+-----------+--------------------------------+------------------------------------------+------------------------------------------------------------------------------------|
| P160             | AUDIO H/U      | CHEC      | 1L-01 1D-FF 1P-240 1N-00 1C-04 | Logical address 01 (communications ctrl) | This is only assumed as the repair manual documents a different LCD display format |
|                  |                |           |                                | DTC code FF                              |                                                                                    |
|                  |                |           |                                | Physical address P240                    |                                                                                    |
|                  |                |           |                                | Connection check number 00               |                                                                                    |
|                  |                |           |                                | Count 04                                 |                                                                                    |
|------------------+----------------+-----------+--------------------------------+------------------------------------------+------------------------------------------------------------------------------------|
| P190             | AUDIO H/U      | GOOD      |                                |                                          |                                                                                    |
| P240             | CD-CH2         | NCON      |                                |                                          |                                                                                    |
|------------------+----------------+-----------+--------------------------------+------------------------------------------+------------------------------------------------------------------------------------|

According to the radio repair manual the NCON condition means that the connected component has not responded to the "Diagnosis Mode ON Request" which is likely for a cheap
non-brand emulator.

** AVC-LAN packet library

|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| Type        | Raw packet                                                                                  | Decoded headers                                                                                                                          | Information fields                                                                    | Description                                                     | Examples                                                                                    | Notes                                                                           |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| ANNOUNCE    | 01 00 160 fff 0f 03 12 01 46                                                                | BRO 160(AUDIO_HU1):12(COMMUNICATION) -> fff(BROADCAST):01(COMM_CTRL) 15(WRITE_DATA) 46                                                   | constant 46                                                                           | Sent every 10s by device 0x160                                  | see above                                                                                   | "any device is use" in SOFTSERVICE                                              |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| REPORT REQ  | 01 00 160 fff 0f 04 12 01 20 09                                                             | BRO 160(AUDIO_HU1):12(COMMUNICATION) -> fff(BROADCAST):01(COMM_CTRL) 15(WRITE_DATA) 20 09                                                | 0x20 xx, where xx is a sequence number                                                |                                                                 | 01 00 160 fff 0f 04 12 01 20 01                                                             | Sent to broadcast                                                               |
|             |                                                                                             |                                                                                                                                          |                                                                                       |                                                                 | 01 00 160 fff 0f 04 12 01 20 02                                                             |                                                                                 |
|             |                                                                                             |                                                                                                                                          |                                                                                       |                                                                 | 01 00 160 fff 0f 04 12 01 20 0b                                                             |                                                                                 |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| REPORT RESP | 01 01 240 160 0f 06 00 01 12 30 0b 00                                                       | UNI 240(CD_CH2):01(COMM_CTRL) -> 160(AUDIO_HU1):12(COMMUNICATION) 15(WRITE_DATA) 30 0b 00                                                | 0x30 xx, where xx is a sequence number (matches the previously sent out REPORT packet |                                                                 | 01 01 190 160 0f 06 00 01 12 30 0c 00                                                       | Unicast response                                                                |
|             |                                                                                             |                                                                                                                                          |                                                                                       |                                                                 | 01 01 240 160 0f 06 00 01 12 30 0a 00                                                       |                                                                                 |
|             |                                                                                             |                                                                                                                                          |                                                                                       |                                                                 | 01 01 240 160 0f 06 00 01 12 30 05 00                                                       |                                                                                 |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| BEEP        | 01 01 160 190 0f 05 00 25 29 60 83                                                          | UNI 160(AUDIO_HU1):25(CMD_SW) -> 190(AUDIO_HU2):29(BEEP_SPEAKERS) 15(WRITE_DATA) 60 83                                                   | 0x60 xx, where xx is the duration of the beep                                         | Audible beep in speakers                                        | 01 01 160 190 0f 05 00 25 29 60 01                                                          |                                                                                 |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| PING        | 01 00 160 fff 0f 03 00 01 0a                                                                | BRO 160(AUDIO_HU1):00() -> fff(BROADCAST):01(COMM_CTRL) 15(WRITE_DATA) 0a                                                                | constant 0x0a                                                                         | Sent to broadcast when a scan is started in LAN diagnostic mode | 01 00 160 fff 0f 03 00 01 0a                                                                | Seen in LAN diag mode, can be unicast or broadcast                              |
|             |                                                                                             |                                                                                                                                          |                                                                                       |                                                                 | 01 01 160 240 0f 04 00 00 01 0a                                                             |                                                                                 |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| PING RESP   | 01 01 190 160 0f 05 00 01 00 1a 01                                                          | UNI 190(AUDIO_HU2):01(COMM_CTRL) -> 160(AUDIO_HU1):00() 15(WRITE_DATA) 1a 01                                                             | constant                                                                              | This seems to be a reply to the PING request                    | 01 01 190 160 0f 05 00 01 00 1a 01                                                          | Seen in LAN diag mode, device reported as NCON in LAN diagnostics when no reply |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| STATE REQ?  | 01 00 160 fff 0f 03 00 01 0c                                                                | BRO 160(AUDIO_HU1):00() -> fff(BROADCAST):01(COMM_CTRL) 15(WRITE_DATA) 0c                                                                | constant                                                                              | Unknown, a different kind of ping?                              | see above                                                                                   | Seen in LAN diag mode, Sent to broadcast                                        |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| STATE RESP? | 01 01 190 160 0f 05 00 01 00 1c 00                                                          | UNI 190(AUDIO_HU2):01(COMM_CTRL) -> 160(AUDIO_HU1):00() 15(WRITE_DATA) 1c 00                                                             | constant                                                                              | Seems to be a response to STATE?                                | 01 01 360 160 0f 05 00 01 00 1c 00                                                          | Unicast                                                                         |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| END SCAN    | 01 00 160 fff 0f 03 00 01 08                                                                | BRO 160(AUDIO_HU1):00() -> fff(BROADCAST):01(COMM_CTRL) 15(WRITE_DATA) 08                                                                | constant                                                                              | Seems to indicate end of LAN diagnostic scan                    | see above                                                                                   | Seen in LAN diag mode when scan ends, sent to broadcast                         |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| END SCAN OK | 01 01 190 160 0f 04 00 01 00 18                                                             | UNI 190(AUDIO_HU2):01(COMM_CTRL) -> 160(AUDIO_HU1):00() 15(WRITE_DATA) 18                                                                | constant                                                                              | A response to END SCAN                                          | 01 01 360 160 0f 04 00 01 00 18                                                             | Seen in LAN diag mode, unicast                                                  |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| PLUG        | 01 00 360 1ff 0f 04 01 11 13 63                                                             | BRO 360(CD_CH1):01(COMM_CTRL) -> 1ff(GROUP1):11() 15(WRITE_DATA) 13 63                                                                   | constant                                                                              | Sent by the CD changer when plugged into the bus                |                                                                                             | Multicast to group 1FF                                                          |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| PLUG ACK    | 01 01 160 360 0f 04 00 25 63 e0                                                             | UNI 160(AUDIO_HU1):25(CMD_SW) -> 360(CD_CH1):63(CD_CHANGER) 15(WRITE_DATA) e0                                                            | constant                                                                              | Seems to be an acknowledgement of the PLUG message              |                                                                                             | Unicast                                                                         |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|
| TRACK NAME  | 01 01 190 160 0f 18 00 62 25 fd 01 02 c0 01 4c 6f 73 74 20 69 6e 20 74 68 65 20 50 69 70 65 | PKT UNI 190(AUDIO_HU2):62(CD) -> 160(AUDIO_HU1):25(CMD_SW) 15(WRITE_DATA) fd 01 02 c0 01 4c 6f 73 74 20 69 6e 20 74 68 65 20 50 69 70 65 | track name -> "Lost in the Pipe"                                                      | Sends track name from CD-Text                                   | 01 01 190 160 0f 18 00 62 25 fd 01 03 c0 01 4f 75 74 20 6f 66 20 41 6e 67 65 72 20 61 6e 64 | Unicast                                                                         |
|-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------|

* Reference

A single other reference for the packet format.
[[http://softservice.com.pl/corolla/avc/avclan.php][SOFTSERVICE]]
